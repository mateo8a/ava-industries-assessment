- csv_file = @migration.csv_file

= form_with(model: @migration) do |f|
    
  %div
    = f.label :description
    = f.text_area :description
    = f.label :notes
    = f.text_area :notes
  
  %div
    %h3 Assign headers to the imported data columns
    
    %table
      %tr
        - csv_file.number_of_columns.times do |i|
          %td
            = select_tag_generator(@migration, i)
      - CSV.parse(csv_file.preview_rows).each_with_index do |r, i|
        %tr
          - r.each do |d|
            - if i == 0 # header row 
              %th
                = d
            - else
              %td
                = d
  
  %div
    = f.submit "Confirm headers"